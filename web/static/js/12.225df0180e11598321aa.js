webpackJsonp([12],{TgNb:function(e,t){},s3nr:function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n={name:"login",data:function(){return{botApi:this.$botApi,loading:!0,loginForm:{apiName:this.$botApi[0],username:"",password:"",list:[]},rules:{username:[{required:!0,message:"请输入账户",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},loginLoading:!1}},methods:{checkQuery:function(e){var t=this;e.hasOwnProperty("user")&&e.hasOwnProperty("salt")?(this.curUser=e.user,this.$ajax({url:"/login.salt",params:e}).then(function(e){0===e.code?t.loginSuccess(e):e.code>500?t.$message({message:e.msg,type:"error",duration:1e3,onClose:function(){t.$router.push("/index")}}):t.$message({message:e.msg,type:"error",duration:1e3,onClose:function(){t.loading=!1}})}).catch(function(){t.loading=!1})):this.loading=!1},loginSubmit:function(){var e=this;this.loginLoading=!0,this.$refs.loginForm.validate(function(t){t?e.$ajax({url:"/login",params:{apiName:e.loginForm.apiName,user_id:e.loginForm.username,password:e.loginForm.password}}).then(function(t){0===t.code?e.loginSuccess(t):(e.loginLoading=!1,e.$message.error(t.msg))}).catch(function(){e.loginLoading=!1}):(e.loginLoading=!1,e.$message.warning("表单验证未通过"))})},loginSuccess:function(e){var t=this,o=e.data;0===e.data.login_count?this.$message({type:"success",message:"您是首次登录,请重置密码",duration:1e3,onClose:function(){t.$router.push({path:"/reset-pwd",query:{user:o.user_id,salt:o.salt}})}}):(this.$cookies.set("token",e.data.token),this.$cookies.set("user_id",e.data.user_id),this.$cookies.set("salt",e.data.salt),this.$cookies.set("login_count",e.data.login_count),this.$message({type:"success",message:e.msg,duration:1e3,onClose:function(){t.$router.push("/index").then(function(){return window.location.reload()})}}))}},mounted:function(){var e=this.$route.query;this.checkQuery(e)}},s={render:function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[o("el-header",[o("h2",[e._v("XmBot")])]),e._v(" "),o("el-main",{staticClass:"text-center"},[o("el-card",{staticClass:"login-box display-inline-block"},[o("el-row",[o("span",{staticClass:"login-title"},[e._v("登录")])]),e._v(" "),o("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,"label-width":"auto",rules:e.rules}},[o("el-form-item",{attrs:{label:"账户",prop:"username"}},[o("el-input",{attrs:{placeholder:"请输入账户"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loginSubmit(t)}},model:{value:e.loginForm.username,callback:function(t){e.$set(e.loginForm,"username",t)},expression:"loginForm.username"}},[o("el-select",{staticStyle:{width:"70px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:e.loginForm.apiName,callback:function(t){e.$set(e.loginForm,"apiName",t)},expression:"loginForm.apiName"}},e._l(e.botApi,function(e,t){return o("el-option",{key:t,attrs:{value:e,label:String(e).toUpperCase()}})}),1)],1)],1),e._v(" "),o("el-form-item",{attrs:{label:"密码",prop:"password"}},[o("el-input",{attrs:{type:"password",placeholder:"请输入密码"},nativeOn:{keypress:function(t){return!t.type.indexOf("key")&&e._k(t.keyCode,"enter",13,t.key,"Enter")?null:e.loginSubmit(t)}},model:{value:e.loginForm.password,callback:function(t){e.$set(e.loginForm,"password",t)},expression:"loginForm.password"}})],1)],1),e._v(" "),o("el-row",[o("el-button",{attrs:{type:"primary",icon:"el-icon-check",size:"small",loading:e.loginLoading},on:{click:e.loginSubmit}},[e._v("登录\n        ")]),e._v(" "),o("el-tooltip",{attrs:{placement:"top",content:"请私聊机器人'登录'"}},[o("el-link",{staticClass:"login-forget-link",attrs:{type:"info"}},[o("el-icon",{staticClass:"el-icon-question"}),e._v("\n            忘记密码\n          ")],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var i=o("VU/8")(n,s,!1,function(e){o("TgNb")},"data-v-3afc7b54",null);t.default=i.exports}});
//# sourceMappingURL=12.225df0180e11598321aa.js.map