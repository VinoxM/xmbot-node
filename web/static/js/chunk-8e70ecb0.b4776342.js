(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-8e70ecb0"],{"0ccb":function(e,t,n){var i=n("50c4"),a=n("1148"),r=n("1d80"),o=Math.ceil,c=function(e){return function(t,n,c){var s,l,u=String(r(t)),d=u.length,f=void 0===c?" ":String(c),m=i(n);return m<=d||""==f?u:(s=m-d,l=a.call(f,o(s/f.length)),l.length>s&&(l=l.slice(0,s)),e?u+l:l+u)}};e.exports={start:c(!1),end:c(!0)}},1148:function(e,t,n){"use strict";var i=n("a691"),a=n("1d80");e.exports="".repeat||function(e){var t=String(a(this)),n="",r=i(e);if(r<0||r==1/0)throw RangeError("Wrong number of repetitions");for(;r>0;(r>>>=1)&&(t+=t))1&r&&(n+=t);return n}},"47c5":function(e,t,n){"use strict";n.d(t,"c",(function(){return a})),n.d(t,"b",(function(){return r})),n.d(t,"d",(function(){return o})),n.d(t,"a",(function(){return c}));var i=n("365c"),a=function(){return Object(i["d"])({url:"/setting/live.json",method:"get"})},r=function(e){return Object(i["d"])({url:"/bili/dynamic.json",method:"get",params:e})},o=function(e){return Object(i["d"])({url:"/setting/live.save",method:"post",data:e})},c=function(e){return Object(i["d"])({url:"/bili/dynamic.delete",method:"post",data:e})}},"4d90":function(e,t,n){"use strict";var i=n("23e7"),a=n("0ccb").start,r=n("9a0c");i({target:"String",proto:!0,forced:r},{padStart:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}})},"5aac":function(e,t,n){"use strict";n("cea8")},6564:function(e,t,n){},"8b63":function(e,t,n){"use strict";n.r(t);var i=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-row",[n("el-drawer",{attrs:{direction:"ttb",visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[n("el-form",{staticClass:"form-box",attrs:{"label-width":"80px",size:"small"}},[n("el-form-item",{attrs:{label:"用户ID"}},[n("el-input",{model:{value:e.form.uid,callback:function(t){e.$set(e.form,"uid",t)},expression:"form.uid"}})],1),n("el-form-item",{attrs:{label:"Csrf"}},[n("el-input",{model:{value:e.form["csrf"],callback:function(t){e.$set(e.form,"csrf",t)},expression:"form['csrf']"}})],1),n("el-form-item",{attrs:{label:"Cookie"}},[n("el-input",{attrs:{type:"textarea",rows:"4",resize:"none"},model:{value:e.form.cookie,callback:function(t){e.$set(e.form,"cookie",t)},expression:"form.cookie"}})],1)],1)],1),n("el-row",{staticClass:"search-tool-bar"},[n("div",{staticStyle:{position:"absolute",left:"10px",top:"0"}},[n("el-button",{attrs:{icon:"el-icon-setting",size:"small"},on:{click:function(t){e.visible=!0}}}),n("el-button",{attrs:{size:"small",type:"primary",loading:e.isSearching,icon:"el-icon-search"},on:{click:function(t){return e.searchDynamic(0)}}},[e._v("Search ")]),n("el-switch",{attrs:{"active-text":"显示完整时间","inactive-text":"只显示日期"},model:{value:e.fullTime,callback:function(t){e.fullTime=t},expression:"fullTime"}})],1),e.userInfo.uid||e.userInfo.mid?n("div",{staticClass:"user-info-box"},[n("div",{staticClass:"face-box"},[n("img",{attrs:{src:e.getFaceSrc()}})]),n("span",{staticClass:"uname-span"},[e._v(e._s(e.userInfo.uname||e.userInfo.name))])]):e._e(),e.userInfo.uid||e.userInfo.mid?n("span",{staticClass:"search-tool-btn"},[n("el-checkbox",{staticStyle:{"margin-right":"6px"},attrs:{indeterminate:e.isIndeterminate},on:{change:e.changeCheckAll},model:{value:e.checkAll,callback:function(t){e.checkAll=t},expression:"checkAll"}}),n("i",{class:e.deleting?"el-icon-loading btn-deleting":"el-icon-delete btn-danger",on:{click:e.deleteAll}}),n("span",{staticClass:"search-expand-btn"},[n("i",{staticClass:"el-icon-arrow-up",on:{click:function(t){return e.retractAll(!1)}}}),n("i",{staticClass:"el-icon-arrow-down",on:{click:function(t){return e.retractAll(!0)}}})])],1):e._e()]),n("el-row",{staticStyle:{position:"relative"}},[n("el-row",{staticClass:"dynamic-box"},[e._l(e.dynamic,(function(t,i){return n("xm-dynamic",{key:i,attrs:{value:t,"full-time":e.fullTime},on:{"update:value":function(e){t=e},selected:e.changeIndeterminate,delete:function(n){return e.delOneDynamic(t,i)}}})})),0!==e.form.offsetId?n("el-row",{staticStyle:{"text-align":"center"}},[e.hasMore?n("el-link",{attrs:{disabled:e.isSearching},on:{click:e.searchDynamic}},[e._v("加载更多")]):n("el-link",{attrs:{disabled:""}},[e._v("没有更多")])],1):e._e()],2),n("el-backtop",{staticStyle:{position:"absolute",right:"10px",bottom:"10px"},attrs:{target:".dynamic-box"}})],1)],1)},a=[];n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");function r(e){return r="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r(e)}var o=n("b85c"),c=(n("d81d"),n("b64b"),n("4d90"),n("a434"),n("c740"),n("b0c0"),n("47c5")),s=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("el-card",{staticStyle:{"margin-bottom":"8px"},attrs:{"body-style":"padding:10px 20px",shadow:"hover"},nativeOn:{click:function(t){return e.changeSelected(e.value.selected)}}},[n("el-row",{directives:[{name:"show",rawName:"v-show",value:!e.value.retract,expression:"!value.retract"}],staticClass:"line-height-32"},[n("span",{staticClass:"text-time-top"},[e._v(e._s(e.fullTime?e.value.item.fullTime:e.value.item.time))]),n("span",{class:e.fullTime?"text-ellipsis padding-long":"text-ellipsis padding-short"},[e._v(e._s(e.value.item.content))]),n("span",{staticStyle:{position:"absolute",right:"0",top:"0"}},[n("el-checkbox",{staticStyle:{"margin-right":"6px"},attrs:{value:e.value.selected},on:{change:e.changeSelected}}),n("i",{class:e.value.deleting?"el-icon-loading btn-deleting":"el-icon-delete btn-icon btn-danger",on:{click:function(t){return t.stopPropagation(),e.delDynamic(t)}}}),n("i",{staticClass:"el-icon-arrow-down btn-icon",staticStyle:{"margin-left":"6px"},on:{click:function(t){t.stopPropagation(),e.value.retract=!0}}})],1)]),n("el-row",{directives:[{name:"show",rawName:"v-show",value:e.value.retract,expression:"value.retract"}]},[n("el-row",{staticClass:"line-height-32"},[n("span",{staticClass:"text-time"},[e._v(e._s(e.fullTime?e.value.item.fullTime:e.value.item.time))]),n("span",{staticStyle:{float:"right"}},[n("el-checkbox",{staticStyle:{"margin-right":"6px"},attrs:{value:e.value.selected},on:{change:e.changeSelected}}),n("i",{class:e.value.deleting?"el-icon-loading btn-deleting":"el-icon-delete btn-icon btn-danger",on:{click:function(t){return t.stopPropagation(),e.delDynamic(t)}}}),n("i",{staticClass:"el-icon-arrow-up btn-icon",staticStyle:{"margin-left":"6px"},on:{click:function(t){t.stopPropagation(),e.value.retract=!1}}})],1)]),n("p",{staticClass:"text-ellipsis",staticStyle:{padding:"0 5px"},attrs:{title:e.value.item.content}},[e._v(e._s(e.value.item.content))]),0!==e.value.item["orig_dy_id"]?n("el-card",{attrs:{"body-style":"padding:10px 20px;background-color:#f4f5f7",shadow:"never"}},[e.value.origin?n("el-row",{staticClass:"user-info-box-origin"},[n("div",{staticClass:"face-box"},[n("img",{attrs:{src:e.value.origin.user["head_url"]}})]),n("span",{staticClass:"uname-span"},[e._v(e._s(e.value.origin.user.name))]),n("span",{staticClass:"text-time"},[e._v(e._s(e.value.origin.item["upload_time"]))])]):e._e(),n("p",{staticClass:"text-ellipsis",attrs:{title:e.value.origin?e.value.origin.item.description||e.value.origin.item.content:""}},[e._v(" "+e._s(e.value.item.tips||e.value.origin.item.description||e.value.origin.item.content))])],1):e._e()],1)],1)},l=[],u={name:"bili-dynamic",data:function(){return{}},props:["value","fullTime"],methods:{delDynamic:function(){this.value.deleting||(this.value.deleting=!0,this.$emit("delete"))},changeSelected:function(e){this.value.selected=!e,this.$emit("selected")}},created:function(){console.log(this.value)}},d=u,f=(n("5aac"),n("2877")),m=Object(f["a"])(d,s,l,!1,null,"fdee9242",null),h=m.exports,g={name:"bili-dynamic",components:{"xm-dynamic":h},data:function(){return{visible:!1,loading:!1,form:{uid:null,cookie:null,csrf:null,offsetId:0},dynamic:[],hasMore:!0,isSearching:!1,fullTime:!1,deleting:!1,checkAll:!1,isIndeterminate:!1}},computed:{userInfo:function(){return this.dynamic.length>0?this.dynamic[0].user:{face:null,uname:null,uid:null}},urlPrefix:function(){var e=this.$cookies.get("curUrlPrefix");return e?this.$urlConf[e+"_url"]:this.$urlConf["base_url"]}},methods:{getSettings:function(){var e=this;this.loading=!0,c["c"]().then((function(t){if(0!==t["code"])return e.loading=!1,void e.$message.error(t["msg"]);e.form={uid:t.data.uid,cookie:"l=v; "+t.data.cookie,csrf:t.data["csrf_token"],offsetId:0},e.loading=!1})).catch((function(t){e.loading=!1}))},searchDynamic:function(e){var t=this;this.isSearching=!0,0===e&&(this.form.offsetId=0,this.dynamic=[]);var n={uid:this.form.uid||"",cookie:this.form.cookie||"",offsetId:this.form.offsetId};c["b"](n).then((function(e){if(0===e["code"]&&0===e.data["code"])if(t.form.offsetId===e.data.data["next_offset"])t.hasMore=!1;else{t.form.offsetId=e.data.data["next_offset"];var n=e.data.data["cards"];if(n&&n.length>0){var i,a=Object(o["a"])(n);try{for(a.s();!(i=a.n()).done;){var r=i.value,c=t.handleJson(r["card"]);8===r.desc.type&&(c.item={timestamp:c["pubdate"],content:"[Vidoe] "+c.title,orig_dy_id:0},c.user=c.owner),c.item.time=t.handleTime(c.item.timestamp),c.item.fullTime=t.handleTime(c.item.timestamp,!0),c.origin&&(8===c.item["orig_type"]&&(c.origin.item={upload_time:c.origin["pubdate"],content:"[Video] "+c.origin.title},c.origin.user=c.origin.owner),c.origin.item["upload_time"]=t.handleTime(c.origin.item["upload_time"]||c.origin.item["timestamp"]),c.origin.user["head_url"]=t.urlPrefix+"xmbot/web/image.get?url=".concat(c.origin.user["head_url"]||c.origin.user["face"])),c.retract=!1,c.selected=!1,c.desc=r.desc,c.deleting=!1,t.dynamic.push(c)}}catch(s){a.e(s)}finally{a.f()}}}t.changeIndeterminate(),t.isSearching=!1})).catch((function(e){t.isSearching=!1}))},getFaceSrc:function(){return this.userInfo.face?this.urlPrefix+"xmbot/web/image.get?url=".concat(this.userInfo.face):""},handleJson:function(e){var t=this;if("object"===r(e)){if(e instanceof Array)e.map((function(e){return t.handleJson(e)}));else if(e instanceof Object)for(var n=0,i=Object.keys(e);n<i.length;n++){var a=i[n];e[a]=this.handleJson(e[a])}return e}if(""===e)return e;var o="";try{o=JSON.parse(e)}catch(c){return e}return"object"===r(o)?this.handleJson(o):e},handleTime:function(e,t){var n=new Date;return n.setTime(1e3*e),t?"".concat(n.getFullYear(),"-")+"".concat(String(n.getMonth()+1).padStart(2,"0"),"-")+"".concat(String(n.getDate()).padStart(2,"0")," ")+"".concat(String(n.getHours()).padStart(2,"0"),":")+"".concat(String(n.getMinutes()).padStart(2,"0"),":")+"".concat(String(n.getSeconds()).padStart(2,"0")):"".concat(String(n.getMonth()+1).padStart(2,"0"),"-")+"".concat(String(n.getDate()).padStart(2,"0")," ")},delOneDynamic:function(e,t){var n=this,i={dynamic_id:e.desc["dynamic_id_str"],csrf:this.form.csrf,cookie:this.form.cookie};c["a"](i).then((function(e){0===e.data["code"]?(n.dynamic.splice(t,1),n.$message.success(e["msg"])):(n.dynamic[t].deleting=!1,n.$message.error(e["data"].message))})).catch((function(e){n.dynamic[t].deleting=!1}))},changeCheckAll:function(e){this.dynamic.map((function(t){return t.selected=e,t})),this.isIndeterminate=!1},changeIndeterminate:function(){if(this.checkAll=!this.dynamic.some((function(e){return!e.selected})),1===this.dynamic.length)this.isIndeterminate=!1;else{for(var e=!1,t=!0,n=0;n<this.dynamic.length;n++)0!==n?e=t!==this.dynamic[n].selected:t=this.dynamic[n].selected;this.isIndeterminate=e}},retractAll:function(e){this.dynamic.map((function(t){return t.retract=e,t}))},deleteAll:function(){var e=this;this.dynamic.map((function(t){if(!t.selected)return t;t.deleting=!0;var n=t.desc["dynamic_id_str"],i={dynamic_id:n,csrf:e.form.csrf,cookie:e.form.cookie};c["a"](i).then((function(t){var i=e.dynamic.findIndex((function(e){return e.desc["dynamic_id_str"]===n}));0===t.data["code"]?e.dynamic.splice(i,1):e.dynamic[i].deleting=!1})).catch((function(t){var i=e.dynamic.findIndex((function(e){return e.desc["dynamic_id_str"]===n}));e.dynamic[i].deleting=!1}))})),this.checkAll=!1,this.isIndeterminate=!1}},created:function(){var e=this;this.$route.meta.auth?this.checkAuth().then((function(){e.getSettings()})).catch((function(t){e.$router.push("/index"),e.$destroy(e.$options.name)})):this.getSettings()}},p=g,v=(n("bf73"),Object(f["a"])(p,i,a,!1,null,"540b0315",null));t["default"]=v.exports},"9a0c":function(e,t,n){var i=n("342f");e.exports=/Version\/10\.\d+(\.\d+)?( Mobile\/\w+)? Safari\//.test(i)},a434:function(e,t,n){"use strict";var i=n("23e7"),a=n("23cb"),r=n("a691"),o=n("50c4"),c=n("7b0b"),s=n("65f0"),l=n("8418"),u=n("1dde"),d=u("splice"),f=Math.max,m=Math.min,h=9007199254740991,g="Maximum allowed length exceeded";i({target:"Array",proto:!0,forced:!d},{splice:function(e,t){var n,i,u,d,p,v,b=c(this),y=o(b.length),x=a(e,y),S=arguments.length;if(0===S?n=i=0:1===S?(n=0,i=y-x):(n=S-2,i=m(f(r(t),0),y-x)),y+n-i>h)throw TypeError(g);for(u=s(b,i),d=0;d<i;d++)p=x+d,p in b&&l(u,d,b[p]);if(u.length=i,n<i){for(d=x;d<y-i;d++)p=d+i,v=d+n,p in b?b[v]=b[p]:delete b[v];for(d=y;d>y-i+n;d--)delete b[d-1]}else if(n>i)for(d=y-i;d>x;d--)p=d+i-1,v=d+n-1,p in b?b[v]=b[p]:delete b[v];for(d=0;d<n;d++)b[d+x]=arguments[d+2];return b.length=y-i+n,u}})},b85c:function(e,t,n){"use strict";n.d(t,"a",(function(){return a}));n("a4d3"),n("e01a"),n("d3b7"),n("d28b"),n("3ca3"),n("ddb0");var i=n("06c5");function a(e,t){var n;if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=Object(i["a"])(e))||t&&e&&"number"===typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,c=!0,s=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return c=e.done,e},e:function(e){s=!0,o=e},f:function(){try{c||null==n["return"]||n["return"]()}finally{if(s)throw o}}}}},bf73:function(e,t,n){"use strict";n("6564")},c740:function(e,t,n){"use strict";var i=n("23e7"),a=n("b727").findIndex,r=n("44d2"),o="findIndex",c=!0;o in[]&&Array(1)[o]((function(){c=!1})),i({target:"Array",proto:!0,forced:c},{findIndex:function(e){return a(this,e,arguments.length>1?arguments[1]:void 0)}}),r(o)},cea8:function(e,t,n){}}]);
//# sourceMappingURL=chunk-8e70ecb0.b4776342.js.map