webpackJsonp([5],{s3nr:function(e,n,o){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var s={name:"login",data:function(){return{loading:!0,loginForm:{username:"",password:"",list:[]},rules:{username:[{required:!0,message:"请输入账户",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},loginLoading:!1}},methods:{checkQuery:function(e){var n=this;e.hasOwnProperty("user")&&e.hasOwnProperty("salt")?(this.curUser=e.user,this.$ajax({url:"/login.salt",params:e}).then(function(e){0===e.code?n.loginSuccess(e):e.code>500?n.$message({message:e.msg,type:"error",duration:1e3,onClose:function(){n.$router.push("/index")}}):n.$message({message:e.msg,type:"error",duration:1e3,onClose:function(){n.loading=!1}})}).catch(function(){n.loading=!1})):this.loading=!1},loginSubmit:function(){var e=this;this.loginLoading=!0,this.$refs.loginForm.validate(function(n){n?e.$ajax({url:"/login",params:{user_id:e.loginForm.username,password:e.loginForm.password}}).then(function(n){0===n.code?e.loginSuccess(n):(e.loginLoading=!1,e.$message.error(n.msg))}).catch(function(){e.loginLoading=!1}):(e.loginLoading=!1,e.$message.warning("表单验证未通过"))})},loginSuccess:function(e){var n=this,o=e.data;0===e.data.login_count?this.$message({type:"success",message:"您是首次登录,请重置密码",duration:1e3,onClose:function(){n.$router.push({path:"/reset-pwd",query:{user:o.user_id,salt:o.salt}})}}):(this.$cookies.set("token",e.data.token),this.$cookies.set("user_id",e.data.user_id),this.$cookies.set("salt",e.data.salt),this.$cookies.set("login_count",e.data.login_count),this.$message({type:"success",message:e.msg,duration:1e3,onClose:function(){n.$router.push("/index").then(function(){return window.location.reload()})}}))}},mounted:function(){var e=this.$route.query;this.checkQuery(e)}},t={render:function(){var e=this,n=e.$createElement,o=e._self._c||n;return o("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[o("el-header",[o("h2",[e._v("XmBot")])]),e._v(" "),o("el-main",{staticClass:"text-center"},[o("el-card",{staticClass:"login-box display-inline-block"},[o("el-row",[o("span",{staticClass:"login-title"},[e._v("登录")])]),e._v(" "),o("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,"label-width":"auto",rules:e.rules}},[o("el-form-item",{attrs:{label:"账户",prop:"username"}},[o("el-input",{attrs:{placeholder:"请输入账户"},nativeOn:{keypress:function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter")?null:e.loginSubmit(n)}},model:{value:e.loginForm.username,callback:function(n){e.$set(e.loginForm,"username",n)},expression:"loginForm.username"}})],1),e._v(" "),o("el-form-item",{attrs:{label:"密码",prop:"password"}},[o("el-input",{attrs:{type:"password",placeholder:"请输入密码"},nativeOn:{keypress:function(n){return!n.type.indexOf("key")&&e._k(n.keyCode,"enter",13,n.key,"Enter")?null:e.loginSubmit(n)}},model:{value:e.loginForm.password,callback:function(n){e.$set(e.loginForm,"password",n)},expression:"loginForm.password"}})],1)],1),e._v(" "),o("el-row",[o("el-button",{attrs:{type:"primary",icon:"el-icon-check",size:"small",loading:e.loginLoading},on:{click:e.loginSubmit}},[e._v("登录\n        ")]),e._v(" "),o("el-tooltip",{attrs:{placement:"top",content:"请私聊机器人'登录'"}},[o("el-link",{staticClass:"login-forget-link",attrs:{type:"info"}},[o("el-icon",{staticClass:"el-icon-question"}),e._v("\n            忘记密码\n          ")],1)],1)],1)],1)],1)],1)},staticRenderFns:[]};var i=o("VU/8")(s,t,!1,function(e){o("x4Pw")},"data-v-53dcca74",null);n.default=i.exports},x4Pw:function(e,n){}});
//# sourceMappingURL=5.b3a93b190a376ecf90ca.js.map