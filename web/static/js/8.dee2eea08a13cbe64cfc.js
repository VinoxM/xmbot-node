webpackJsonp([8],{"X+6L":function(e,r,s){"use strict";Object.defineProperty(r,"__esModule",{value:!0});var t=s("Xxa5"),a=s.n(t),n=s("exGp"),o=s.n(n),i={name:"reset-pwd",data:function(){var e=this;return{loading:!0,resetForm:{password:"",password_twice:""},rules:{password:[{required:!0,message:"请输入密码",trigger:"blur"},{validator:function(e,r,s){""===r?s(new Error("密码不能为空")):r.length<6?s(new Error("密码位数不能小于6位")):s()},trigger:"blur"}],password_twice:[{required:!0,message:"请再次输入密码",trigger:"blur"},{validator:function(r,s,t){""===s?t(new Error("密码不能为空")):s!==e.resetForm.password?t(new Error("两次输入密码不一致")):t()},trigger:"blur"}]},resetLoading:!1,curUser:""}},methods:{checkQuery:function(e){var r=this;return o()(a.a.mark(function s(){var t;return a.a.wrap(function(s){for(;;)switch(s.prev=s.next){case 0:if(t=null,!e.hasOwnProperty("user")||!e.hasOwnProperty("salt")){s.next=7;break}return r.curUser=e.user,s.next=5,r.$ajax({url:"/salt-valid",params:e}).then(function(e){0===e.code?(r.loading=!1,t=!0):r.errorAndToIndex(e.msg)}).catch(function(e){r.errorAndToIndex()});case 5:s.next=8;break;case 7:t=!1;case 8:return s.abrupt("return",t);case 9:case"end":return s.stop()}},s,r)}))()},errorAndToIndex:function(e){var r=this;this.$message({type:"error",message:e+",即将跳转到首页",duration:1e3,onClose:function(){r.$router.push("/index")}})},resetSubmit:function(){var e=this;this.resetLoading=!0,this.$refs.resetForm.validate(function(r){r?e.$ajax({url:"/reset-pwd",params:{user_id:e.user_id,password:e.resetForm.password}}).then(function(r){e.resetLoading=!1,0===r.code?(e.$cookies.remove("user_info"),e.$cookies.remove("token"),e.$message({message:r.msg,type:"success",duration:1e3,onClose:function(){e.$router.push("/login")}})):e.$message.error(r.msg)}):(e.resetLoading=!1,e.$message.warning("表单验证未通过"))})}},mounted:function(){var e=this;return o()(a.a.mark(function r(){var s;return a.a.wrap(function(r){for(;;)switch(r.prev=r.next){case 0:return s=e.$route.query,r.next=3,e.checkQuery(s);case 3:if(r.sent){r.next=5;break}e.errorAndToIndex("参数不正确");case 5:case"end":return r.stop()}},r,e)}))()}},c={render:function(){var e=this,r=e.$createElement,s=e._self._c||r;return s("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[s("el-header",[s("h2",[e._v("XmBot")])]),e._v(" "),s("el-main",{staticClass:"text-center"},[s("el-card",{staticClass:"reset-box display-inline-block"},[s("el-row",[s("span",{staticClass:"reset-title"},[e._v("重置密码("+e._s(e.curUser)+")")])]),e._v(" "),s("el-form",{ref:"resetForm",staticClass:"reset-form",attrs:{model:e.resetForm,"label-width":"auto",rules:e.rules}},[s("el-form-item",{attrs:{label:"新密码",prop:"password"}},[s("el-input",{attrs:{type:"password",placeholder:"请输入密码"},model:{value:e.resetForm.password,callback:function(r){e.$set(e.resetForm,"password",r)},expression:"resetForm.password"}})],1),e._v(" "),s("el-form-item",{attrs:{label:"密码确认",prop:"password_twice"}},[s("el-input",{attrs:{type:"password",placeholder:"请再次输入密码"},model:{value:e.resetForm.password_twice,callback:function(r){e.$set(e.resetForm,"password_twice",r)},expression:"resetForm.password_twice"}})],1)],1),e._v(" "),s("el-row",[s("el-button",{attrs:{type:"primary",icon:"el-icon-check",size:"small",loading:e.resetLoading},on:{click:e.resetSubmit}},[e._v("确认\n        ")])],1)],1)],1)],1)},staticRenderFns:[]};var u=s("VU/8")(i,c,!1,function(e){s("kjWA")},"data-v-298f1ff6",null);r.default=u.exports},kjWA:function(e,r){}});
//# sourceMappingURL=8.dee2eea08a13cbe64cfc.js.map