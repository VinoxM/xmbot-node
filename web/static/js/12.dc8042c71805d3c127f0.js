webpackJsonp([12],{nnmt:function(t,e){},qdI8:function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var l=s("mvHQ"),i=s.n(l),a=s("gyMJ"),n={name:"rss-setting",data:function(){return{setting:{},loading:!1,testLoading:!1,testVisible:!1,testTitle:"",testResult:{body:"",line:""},addVisible:!1,addForm:{title:"",on:!0,proxy:!0,source:"",name:"",name_filter:[],link_replace:"",push_group:"all",push_user:"all",last_id:""},rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],source:[{required:!0,message:"请输入源网址",trigger:"blur"}],name:[{required:!0,message:"请输入键名",trigger:"blur"}],link_replace:[{required:!0,message:"请输入提取链接",trigger:"blur"}]},submitLoading:!1}},computed:{isAdmin:function(){return this.$store.state.isAdmin}},methods:{sourceTest:function(t,e){var s,l=this;t&&""!==t&&(this.testLoading=!0,(s={source:t,proxy:e},Object(a.d)({url:"/rss/source/test.do",method:"get",params:s})).then(function(e){0===e.code?(l.testTitle=t,l.testResult=e.data,l.testVisible=!0):l.$message.error(e.msg),l.testLoading=!1}).catch(function(t){l.testLoading=!1}))},getJsonFormat:function(t){return t&&""!==t?i()(t,null,4):""},rssAdd:function(){this.addVisible=!0},rssDel:function(t){this.setting.rss.splice(t,1)},addSubmit:function(){var t=this;this.submitLoading=!0,this.$refs.addForm.validate(function(e){e?(t.setting.rss.push(t.addForm),t.addVisible=!1):t.submitLoading=!1})},addFormInit:function(){this.addForm={title:"",on:!0,proxy:!0,source:"",name:"",name_filter:[],link_replace:"",push_group:"all",push_user:"all",last_id:""}},rssSave:function(){var t,e=this;(t=this.setting,Object(a.d)({url:"/setting/rss.save",method:"post",data:t})).then(function(t){e.$message[0===t.code?"success":"error"](t.msg)})}},created:function(){var t=this;this.loading=!0,Object(a.d)({url:"/setting/rss.json",method:"get"}).then(function(e){t.setting=e.data,t.loading=!1}).catch(function(t){})}},r={render:function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("el-row",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticClass:"position-relative"},[s("div",{staticClass:"tool-btn"},[t.isAdmin?s("el-button",{attrs:{size:"small",type:"primary"},on:{click:t.rssSave}},[t._v("保存本页")]):t._e()],1),t._v(" "),t.loading?t._e():s("el-form",{ref:"form",attrs:{model:t.setting,"label-width":"100px"}},[s("el-form-item",{attrs:{label:"初始化时间"}},[s("el-input-number",{staticStyle:{width:"100px"},attrs:{controls:!1,size:"small",disabled:!t.isAdmin},model:{value:t.setting.initial_time.time,callback:function(e){t.$set(t.setting.initial_time,"time",e)},expression:"setting['initial_time']['time']"}}),t._v(" "),s("el-select",{staticStyle:{width:"60px"},attrs:{size:"small",disabled:!t.isAdmin},model:{value:t.setting.initial_time.units,callback:function(e){t.$set(t.setting.initial_time,"units",e)},expression:"setting['initial_time']['units']"}},[s("el-option",{attrs:{label:"时",value:"hours"}}),t._v(" "),s("el-option",{attrs:{label:"分",value:"minutes"}}),t._v(" "),s("el-option",{attrs:{label:"秒",value:"seconds"}})],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"循环时间"}},[s("el-input-number",{staticStyle:{width:"100px"},attrs:{controls:!1,size:"small",disabled:!t.isAdmin},model:{value:t.setting.interval.time,callback:function(e){t.$set(t.setting.interval,"time",e)},expression:"setting['interval']['time']"}}),t._v(" "),s("el-select",{staticStyle:{width:"60px"},attrs:{size:"small",disabled:!t.isAdmin},model:{value:t.setting.interval.units,callback:function(e){t.$set(t.setting.interval,"units",e)},expression:"setting['interval']['units']"}},[s("el-option",{attrs:{label:"时",value:"hours"}}),t._v(" "),s("el-option",{attrs:{label:"分",value:"minutes"}}),t._v(" "),s("el-option",{attrs:{label:"秒",value:"seconds"}})],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"推送列表"}},[s("xm-info-box",{attrs:{title:"群聊",retractable:"",retract:0===t.setting.push_list.group.length}},[s("xm-tags",{attrs:{value:t.setting.push_list.group,disabled:!t.isAdmin},on:{"update:value":function(e){return t.$set(t.setting.push_list,"group",e)}}})],1),t._v(" "),s("xm-info-box",{attrs:{title:"私聊",retractable:"",retract:0===t.setting.push_list.user.length}},[s("xm-tags",{attrs:{value:t.setting.push_list.user,disabled:!t.isAdmin},on:{"update:value":function(e){return t.$set(t.setting.push_list,"user",e)}}})],1)],1),t._v(" "),s("el-form-item",[s("span",{attrs:{slot:"label"},slot:"label"},[s("span",{staticClass:"icon-new-label"},[t._v("订阅源")]),t._v(" "),t.isAdmin?s("i",{staticClass:"el-icon-circle-plus-outline icon-new-button",on:{click:t.rssAdd}}):t._e()]),t._v(" "),t._l(t.setting.rss,function(e,l){return s("xm-info-box",{key:l,attrs:{editable:t.isAdmin,retractable:"",title:e.title},on:{"update:title":function(s){return t.$set(e,"title",s)}}},[t.isAdmin?s("div",{staticClass:"tool-btn"},[s("el-tooltip",{attrs:{content:"删除",placement:"left"}},[s("el-link",{attrs:{type:"danger"},on:{click:function(e){return t.rssDel(l)}}},[s("i",{staticClass:"el-icon-delete-solid"})])],1)],1):t._e(),t._v(" "),s("el-form",{staticClass:"rss-form-box",attrs:{"label-width":"80px"}},[s("el-form-item",{staticClass:"display-inline-block",staticStyle:{width:"200px"},attrs:{label:"启用"}},[s("el-switch",{attrs:{"active-color":"#13ce66",disabled:!t.isAdmin},model:{value:e.on,callback:function(s){t.$set(e,"on",s)},expression:"item.on"}})],1),t._v(" "),s("el-form-item",{staticClass:"display-inline-block",attrs:{label:"启用代理"}},[s("el-switch",{attrs:{"active-color":"#13ce66",disabled:!t.isAdmin},model:{value:e.proxy,callback:function(s){t.$set(e,"proxy",s)},expression:"item.proxy"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"源网址"}},[s("el-input",{attrs:{readonly:!t.isAdmin},model:{value:e.source,callback:function(s){t.$set(e,"source",s)},expression:"item.source"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-s-promotion",loading:t.testLoading},on:{click:function(s){return t.sourceTest(e.source,e.proxy)}},slot:"append"},[t._v("测试\n              ")])],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"键名"}},[s("el-input",{attrs:{readonly:""},model:{value:e.name,callback:function(s){t.$set(e,"name",s)},expression:"item.name"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"关键词"}},[s("xm-tags",{attrs:{value:e.name_filter,disabled:!t.isAdmin},on:{"update:value":function(s){return t.$set(e,"name_filter",s)}}})],1),t._v(" "),s("el-form-item",{attrs:{label:"提取链接"}},[s("el-input",{attrs:{readonly:!t.isAdmin},model:{value:e.link_replace,callback:function(s){t.$set(e,"link_replace",s)},expression:"item['link_replace']"}})],1),t._v(" "),s("el-form-item",{staticClass:"not-margin",attrs:{label:"推送列表"}},[s("xm-info-box",{attrs:{title:"群聊"}},[s("el-checkbox",{attrs:{disabled:!t.isAdmin,checked:"all"===e.push_group||!e.push_group instanceof Array,label:"全局推送"},on:{change:function(t){e.push_group=t?"all":[]}}}),t._v(" "),"all"!==e.push_group?s("xm-tags",{attrs:{value:e.push_group,disabled:!t.isAdmin},on:{"update:value":function(s){return t.$set(e,"push_group",s)}}}):t._e()],1),t._v(" "),s("xm-info-box",{attrs:{title:"私聊"}},[s("el-checkbox",{attrs:{disabled:!t.isAdmin,checked:"all"===e.push_user||!e.push_user instanceof Array,label:"全局推送"},on:{change:function(t){e.push_user=t?"all":[]}}}),t._v(" "),"all"!==e.push_user?s("xm-tags",{attrs:{value:e.push_user,disabled:!t.isAdmin},on:{"update:value":function(s){return t.$set(e,"push_user",s)}}}):t._e()],1)],1)],1)],1)})],2)],1),t._v(" "),s("el-dialog",{attrs:{visible:t.testVisible,title:t.testTitle,center:""},on:{"update:visible":function(e){t.testVisible=e}}},[s("el-collapse",{staticClass:"test-box"},[s("el-collapse-item",{attrs:{title:"body"}},[s("pre",[t._v(t._s(t.testResult.body))])]),t._v(" "),s("el-collapse-item",{attrs:{title:"line"}},[s("pre",[t._v(t._s(t.testResult.line))])])],1)],1),t._v(" "),s("el-dialog",{attrs:{visible:t.addVisible,title:"添加RSS",center:"","close-on-click-modal":!1},on:{"update:visible":function(e){t.addVisible=e},closed:t.addFormInit}},[s("el-form",{ref:"addForm",attrs:{"label-width":"90px",model:t.addForm,rules:t.rules}},[s("el-form-item",{attrs:{label:"标题",prop:"title"}},[s("el-input",{attrs:{placeholder:"输入标题"},model:{value:t.addForm.title,callback:function(e){t.$set(t.addForm,"title",e)},expression:"addForm.title"}})],1),t._v(" "),s("el-form-item",{staticClass:"display-inline-block",staticStyle:{width:"200px"},attrs:{label:"启用"}},[s("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:t.addForm.on,callback:function(e){t.$set(t.addForm,"on",e)},expression:"addForm.on"}})],1),t._v(" "),s("el-form-item",{staticClass:"display-inline-block",attrs:{label:"启用代理"}},[s("el-switch",{attrs:{"active-color":"#13ce66"},model:{value:t.addForm.proxy,callback:function(e){t.$set(t.addForm,"proxy",e)},expression:"addForm.proxy"}})],1),t._v(" "),s("el-form-item",{attrs:{prop:"source"}},[s("span",{staticStyle:{height:"24px","line-height":"24px"},attrs:{slot:"label"},slot:"label"},[s("el-tooltip",{attrs:{content:"网址例子:https://docs.rsshub.app/",placement:"top"}},[s("el-link",{attrs:{href:"https://docs.rsshub.app/",target:"_blank"}},[t._v("源网址"),s("i",{staticClass:"el-icon-question"})])],1)],1),t._v(" "),s("el-input",{attrs:{placeholder:"输入源rss网址"},model:{value:t.addForm.source,callback:function(e){t.$set(t.addForm,"source",e)},expression:"addForm.source"}},[s("el-button",{attrs:{slot:"append",icon:"el-icon-s-promotion",loading:t.testLoading},on:{click:function(e){return t.sourceTest(t.addForm.source,t.addForm.proxy)}},slot:"append"},[t._v("测试\n          ")])],1)],1),t._v(" "),s("el-form-item",{attrs:{label:"键名",prop:"name"}},[s("el-input",{attrs:{placeholder:"输入键名,勿与已有rss重复"},model:{value:t.addForm.name,callback:function(e){t.$set(t.addForm,"name",e)},expression:"addForm.name"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"关键词"}},[s("xm-tags",{attrs:{value:t.addForm.name_filter},on:{"update:value":function(e){return t.$set(t.addForm,"name_filter",e)}}})],1),t._v(" "),s("el-form-item",{attrs:{label:"提取链接",prop:"link_replace"}},[s("el-input",{attrs:{placeholder:"输入提取链接"},model:{value:t.addForm.link_replace,callback:function(e){t.$set(t.addForm,"link_replace",e)},expression:"addForm['link_replace']"}})],1),t._v(" "),s("el-form-item",{attrs:{label:"推送列表"}},[s("xm-info-box",{attrs:{title:"群聊"}},[s("el-checkbox",{attrs:{checked:"all"===t.addForm.push_group||!t.addForm.push_group instanceof Array,label:"全局推送"},on:{change:function(e){t.addForm.push_group=e?"all":[]}}}),t._v(" "),"all"!==t.addForm.push_group?s("xm-tags",{attrs:{value:t.addForm.push_group,disabled:!t.isAdmin},on:{"update:value":function(e){return t.$set(t.addForm,"push_group",e)}}}):t._e()],1),t._v(" "),s("xm-info-box",{attrs:{title:"私聊"}},[s("el-checkbox",{attrs:{checked:"all"===t.addForm.push_user||!t.addForm.push_user instanceof Array,label:"全局推送"},on:{change:function(e){t.addForm.push_user=e?"all":[]}}}),t._v(" "),"all"!==t.addForm.push_user?s("xm-tags",{attrs:{value:t.addForm.push_user,disabled:!t.isAdmin},on:{"update:value":function(e){return t.$set(t.addForm,"push_user",e)}}}):t._e()],1)],1)],1),t._v(" "),s("el-row",{staticClass:"text-center"},[s("el-button",{attrs:{size:"small",type:"primary",loading:t.submitLoading},on:{click:t.addSubmit}},[t._v("提交")]),t._v(" "),s("el-button",{attrs:{size:"small"},on:{click:function(e){t.addVisible=!1}}},[t._v("取消")])],1)],1)],1)},staticRenderFns:[]};var o=s("VU/8")(n,r,!1,function(t){s("nnmt")},"data-v-3b389522",null);e.default=o.exports}});
//# sourceMappingURL=12.dc8042c71805d3c127f0.js.map