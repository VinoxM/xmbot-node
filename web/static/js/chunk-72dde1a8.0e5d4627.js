(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-72dde1a8"],{"0084":function(e,o,t){"use strict";t("0bb5")},"0bb5":function(e,o,t){},d570:function(e,o,t){"use strict";t.r(o);var n=function(){var e=this,o=e.$createElement,t=e._self._c||o;return t("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[t("el-header",[t("h2",[t("span",{staticClass:"xm-link",on:{click:function(o){return e.$router.push("/index")}}},[e._v("XmBot")])])]),t("el-main",{staticClass:"text-center"},[t("el-card",{staticClass:"login-box display-inline-block"},[t("el-row",[t("span",{staticClass:"login-title"},[e._v("登录")])]),t("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{model:e.loginForm,"label-width":"auto",rules:e.rules}},[t("el-form-item",{attrs:{label:"账户",prop:"username"}},[t("el-input",{attrs:{placeholder:"请输入账户"},nativeOn:{keypress:function(o){return!o.type.indexOf("key")&&e._k(o.keyCode,"enter",13,o.key,"Enter")?null:e.loginSubmit(o)}},model:{value:e.loginForm.username,callback:function(o){e.$set(e.loginForm,"username",o)},expression:"loginForm.username"}},[t("el-select",{staticStyle:{width:"70px"},attrs:{slot:"prepend"},slot:"prepend",model:{value:e.loginForm.apiName,callback:function(o){e.$set(e.loginForm,"apiName",o)},expression:"loginForm.apiName"}},e._l(e.botApi,(function(e,o){return t("el-option",{key:o,attrs:{value:e,label:String(e).toUpperCase()}})})),1)],1)],1),t("el-form-item",{attrs:{label:"密码",prop:"password"}},[t("el-input",{attrs:{type:"password",placeholder:"请输入密码"},nativeOn:{keypress:function(o){return!o.type.indexOf("key")&&e._k(o.keyCode,"enter",13,o.key,"Enter")?null:e.loginSubmit(o)}},model:{value:e.loginForm.password,callback:function(o){e.$set(e.loginForm,"password",o)},expression:"loginForm.password"}})],1)],1),t("el-row",[t("el-button",{attrs:{type:"primary",icon:"el-icon-check",size:"small",loading:e.loginLoading},on:{click:e.loginSubmit}},[e._v("登录 ")]),t("el-tooltip",{attrs:{placement:"top",content:"请私聊机器人'登录'"}},[t("el-link",{staticClass:"login-forget-link",attrs:{type:"info"}},[t("el-icon",{staticClass:"el-icon-question"}),e._v(" 忘记密码 ")],1)],1)],1)],1)],1)],1)},s=[],i={name:"login",data:function(){return{botApi:this.$botApi,loading:!0,loginForm:{apiName:this.$botApi[0],username:"",password:"",list:[]},rules:{username:[{required:!0,message:"请输入账户",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},loginLoading:!1}},methods:{checkQuery:function(e){var o=this;e.hasOwnProperty("user")&&e.hasOwnProperty("salt")?(this.curUser=e.user,this.$ajax({url:"/login.salt",params:e}).then((function(e){0===e["code"]?o.loginSuccess(e):e["code"]>500?o.$message({message:e["msg"],type:"error",duration:1e3,onClose:function(){o.$router.push("/index")}}):o.$message({message:e["msg"],type:"error",duration:1e3,onClose:function(){o.loading=!1}})})).catch((function(){o.loading=!1}))):this.loading=!1},loginSubmit:function(){var e=this;this.loginLoading=!0,this.$refs.loginForm.validate((function(o){o?e.$ajax({url:"/login",params:{apiName:e.loginForm.apiName,user_id:e.loginForm.username,password:e.loginForm.password}}).then((function(o){0===o["code"]?e.loginSuccess(o):(e.loginLoading=!1,e.$message.error(o["msg"]))})).catch((function(){e.loginLoading=!1})):(e.loginLoading=!1,e.$message.warning("表单验证未通过"))}))},loginSuccess:function(e){var o=this,t=e.data;0===e.data["login_count"]?this.$message({type:"success",message:"您是首次登录,请重置密码",duration:1e3,onClose:function(){o.$router.push({path:"/reset-pwd",query:{user:t.user_id,salt:t.salt}})}}):(this.$store.commit("updateIsLogin",!0),this.$cookies.set("token",e.data.token),this.$cookies.set("user_id",e.data.user_id),this.$cookies.set("salt",e.data.salt),this.$cookies.set("login_count",e.data["login_count"]),this.$message({type:"success",message:e["msg"],duration:1e3,onClose:function(){o.$router.push("/index").then((function(){window.location.reload()}))}}))}},mounted:function(){var e=this.$route.query;this.checkQuery(e)}},a=i,r=(t("0084"),t("2877")),l=Object(r["a"])(a,n,s,!1,null,"7cdf17ee",null);o["default"]=l.exports}}]);
//# sourceMappingURL=chunk-72dde1a8.0e5d4627.js.map